webpackJsonp([1],{"9xt0":function(t,i){},NHnr:function(t,i,r){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var s=r("7+uW"),e=r("mvHQ"),o=r.n(e),c={name:"Tetris",mounted:function(){this.ctx=document.querySelector("#canvas").getContext("2d"),this.ctx.canvas.width=this.tetrisCfgs.column*this.tetrisCfgs.unitSize,this.ctx.canvas.height=this.tetrisCfgs.row*this.tetrisCfgs.unitSize},data:function(){return{lastTime:0,current:0,elapsed:0,delta:0,tick:0,gameSpeed:30,rotateDelay:200,moveDelay:50,rotateReady:!0,moveReady:!0,iFPS:60,canvas:null,ctx:null,tetrisCfgs:{row:20,column:10,unitSize:30},tetrisCenter:0,tetrisGrid:[],gameMsg:null,score:0,loop:null,touchBottom:!0,brick:{},brickPatterns:[],gamePad:{up:!1,right:!1,down:!1,left:!1}}},methods:{game:function(t){this.current=t,this.elapsed=this.current-this.lastTime,this.tick=this.tick+1,this.elapsed<1e3/this.iFPS?this.loop=requestAnimationFrame(this.game):(this.loop=requestAnimationFrame(this.game),this.update(),this.render(),this.lastTime=this.current)},init:function(){this.initBrickPatterns(this.tetrisCfgs.column/2-1),this.tetrisGrid=[];for(var t=0;t<this.tetrisCfgs.row;t++){for(var i=[],r=0;r<this.tetrisCfgs.column;r++)i.push({status:0,x:r*this.tetrisCfgs.unitSize,y:t*this.tetrisCfgs.unitSize});this.tetrisGrid.push(i)}this.score=0,this.gameMsg=null,this.loadController()},update:function(){if(this.touchBottom)this.generateBrick(),this.touchBottom=!1;else switch(this.tick>=this.gameSpeed&&(this.dropBrick(),this.tick%=this.gameSpeed),!0){case this.gamePad.up:this.rotateBrick();break;case this.gamePad.down:this.dropBrick();break;case this.gamePad.left:this.moveBrick("left");break;case this.gamePad.right:this.moveBrick("right")}this.examineGameOver()},render:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height);for(var t=0;t<this.tetrisCfgs.row;t++)for(var i=0;i<this.tetrisCfgs.column;i++)if(0!==this.tetrisGrid[t][i].status){var r=this.tetrisGrid[t][i].x,s=this.tetrisGrid[t][i].y;this.ctx.fillRect(r,s,this.tetrisCfgs.unitSize,this.tetrisCfgs.unitSize)}},start:function(){this.init(),this.loop=requestAnimationFrame(this.game)},pause:function(){cancelAnimationFrame(this.loop)},initBrickPatterns:function(t){this.brickPatterns=[[[{x:t-1,y:0},{x:t,y:0},{x:t+1,y:0},{x:t+2,y:0}],[{x:t,y:-1},{x:t,y:0},{x:t,y:1},{x:t,y:2}]],[[{x:t-1,y:0},{x:t,y:0},{x:t,y:1},{x:t+1,y:0}],[{x:t-1,y:0},{x:t,y:-1},{x:t,y:0},{x:t,y:1}],[{x:t-1,y:0},{x:t,y:0},{x:t,y:-1},{x:t+1,y:0}],[{x:t,y:-1},{x:t,y:0},{x:t,y:1},{x:t+1,y:0}]],[[{x:t-1,y:1},{x:t,y:0},{x:t,y:1},{x:t+1,y:0}],[{x:t-1,y:-1},{x:t-1,y:0},{x:t,y:0},{x:t,y:1}]],[[{x:t,y:0},{x:t,y:1},{x:t+1,y:0},{x:t+1,y:1}]],[[{x:t-1,y:0},{x:t,y:0},{x:t,y:1}],[{x:t-1,y:0},{x:t,y:0},{x:t,y:-1}],[{x:t,y:-1},{x:t,y:0},{x:t+1,y:0}],[{x:t,y:0},{x:t+1,y:0},{x:t,y:1}]],[[{x:t-1,y:0},{x:t,y:0},{x:t+1,y:0}],[{x:t,y:-1},{x:t,y:0},{x:t,y:1}]],[[{x:t-1,y:0},{x:t,y:0},{x:t+1,y:0}],[{x:t,y:-1},{x:t,y:0},{x:t,y:1}]],[[{x:t,y:0},{x:t+1,y:0}],[{x:t,y:0},{x:t,y:1}]],[[{x:t,y:0}]]]},generateBrick:function(){var t=this;this.brick={};var i=Math.floor(Math.random()*this.brickPatterns.length);this.brick.coord=JSON.parse(o()(this.brickPatterns[i][0])),this.brick.type=i,this.brick.dir=0,this.brick.bottomLimit=this.brick.coord.reduce(function(t,i){return Math.max(t,i.y)},0),this.brick.leftLimit=this.brick.coord.reduce(function(t,i){return Math.min(t,i.x)},this.tetrisCfgs.column-1),this.brick.rightLimit=this.brick.coord.reduce(function(t,i){return Math.max(t,i.x)},0),this.brick.coord.forEach(function(i){t.tetrisGrid[i.y][i.x].status=1})},dropBrick:function(){var t=this;this.brickTouchBottom()||this.brickCollideBot()?(this.brick.coord.forEach(function(i){t.tetrisGrid[i.y][i.x].status=2}),this.brick.coord=[],this.touchBottom=!0,this.clearRow()):(this.brick.coord.forEach(function(i){t.tetrisGrid[i.y][i.x].status=0}),this.brick.coord=this.brick.coord.map(function(t){return t.y+=1,t}),this.brick.bottomLimit+=1,this.brick.coord.forEach(function(i){t.tetrisGrid[i.y][i.x].status=1}))},moveBrick:function(t){var i=this;this.moveReady&&("left"!==t||this.brickCollideLeft()||(this.moveReady=!1,this.brick.coord.forEach(function(t){i.tetrisGrid[t.y][t.x].status=0}),this.brick.coord=this.brick.coord.map(function(t){return t.x-=1,t}),this.brick.leftLimit-=1,this.brick.rightLimit-=1,this.brick.coord.forEach(function(t){i.tetrisGrid[t.y][t.x].status=1}),setTimeout(function(){i.moveReady=!0},this.moveDelay)),"right"!==t||this.brickCollideRight()||(this.moveReady=!1,this.brick.coord.forEach(function(t){i.tetrisGrid[t.y][t.x].status=0}),this.brick.coord=this.brick.coord.map(function(t){return t.x+=1,t}),this.brick.leftLimit+=1,this.brick.rightLimit+=1,this.brick.coord.forEach(function(t){i.tetrisGrid[t.y][t.x].status=1}),setTimeout(function(){i.moveReady=!0},this.moveDelay)))},rotateBrick:function(){var t=this;if(this.rotateReady){this.rotateReady=!1;for(var i=[],r=this.brick.type,s=this.brickPatterns[this.brick.type].length,e=(this.brick.dir+1)%s,c=0;c<this.brickPatterns[r][this.brick.dir].length;c++){var n={x:this.brickPatterns[r][e][c].x-this.brickPatterns[r][this.brick.dir][c].x,y:this.brickPatterns[r][e][c].y-this.brickPatterns[r][this.brick.dir][c].y};i.push(n)}for(var a=[],h=0;h<this.brick.coord.length;h++){var u={x:this.brick.coord[h].x+i[h].x,y:this.brick.coord[h].y+i[h].y};a.push(u)}if(a.some(function(i){return i.x<0||i.x>=t.tetrisCfgs.column||i.y<0||i.y>=t.tetrisCfgs.row}))this.rotateReady=!0;else a.some(function(i){return 2===t.tetrisGrid[i.y][i.x].status})?this.rotateReady=!0:(this.brick.coord.forEach(function(i){t.tetrisGrid[i.y][i.x].status=0}),this.brick.coord=JSON.parse(o()(a)),this.brick.coord.forEach(function(i){t.tetrisGrid[i.y][i.x].status=1}),this.brick.bottomLimit=this.brick.coord.reduce(function(t,i){return Math.max(t,i.y)},0),this.brick.leftLimit=this.brick.coord.reduce(function(t,i){return Math.min(t,i.x)},this.tetrisCfgs.column-1),this.brick.rightLimit=this.brick.coord.reduce(function(t,i){return Math.max(t,i.x)},0),this.brick.dir=e,setTimeout(function(){t.rotateReady=!0},this.rotateDelay))}},loadController:function(){var t=this;addEventListener("keydown",function(i){38===i.keyCode&&(t.gamePad.up=!0),40===i.keyCode&&(t.gamePad.down=!0),37===i.keyCode?t.gamePad.left=!0:39===i.keyCode&&(t.gamePad.right=!0)}),addEventListener("keyup",function(i){38===i.keyCode&&(t.gamePad.up=!1),40===i.keyCode&&(t.gamePad.down=!1),37===i.keyCode?t.gamePad.left=!1:39===i.keyCode&&(t.gamePad.right=!1)})},brickTouchBottom:function(){return this.brick.bottomLimit>=this.tetrisCfgs.row-1},brickCollideBot:function(){var t=this;return this.brick.coord.some(function(i){return 2===t.tetrisGrid[i.y+1][i.x].status})},brickCollideLeft:function(){var t=this;return this.brick.leftLimit<=0||this.brick.coord.some(function(i){return 2===t.tetrisGrid[i.y][i.x-1].status})},brickCollideRight:function(){var t=this;return this.brick.rightLimit>=this.tetrisCfgs.column-1||this.brick.coord.some(function(i){return 2===t.tetrisGrid[i.y][i.x+1].status})},clearRow:function(){for(var t=[],i=this.tetrisGrid.map(function(i,r){return i.every(function(t){return 2===t.status})?(t.push(r),i.map(function(t){return{status:0}})):JSON.parse(o()(i))}),r=[],s=0;s<this.tetrisCfgs.column;s++)r.push({status:0});for(var e=0;e<t.length;e++)i.splice(t[e],1),i.unshift(r);if(t.length>0)for(var c=0;c<this.tetrisCfgs.row;c++)for(var n=0;n<this.tetrisCfgs.column;n++)this.tetrisGrid[c][n].status=i[c][n].status;this.score+=5*t.length,t=[]},examineGameOver:function(){this.tetrisGrid[0].some(function(t){return 2===t.status})&&(this.gameMsg="Game Over",this.pause())}}},n={render:function(){var t=this,i=t.$createElement,r=t._self._c||i;return r("div",[r("p",[t._v(t._s(t.gameMsg))]),t._v(" "),r("p",[t._v("Score: "+t._s(t.score))]),t._v(" "),r("canvas",{attrs:{id:"canvas"}}),t._v(" "),r("button",{on:{click:t.start}},[t._v("Start")]),t._v(" "),r("button",{on:{click:t.pause}},[t._v("Pause")])])},staticRenderFns:[]};var a={name:"App",components:{Tetris:r("VU/8")(c,n,!1,function(t){r("n0+5")},"data-v-3f796014",null).exports}},h={render:function(){var t=this.$createElement,i=this._self._c||t;return i("div",{attrs:{id:"app"}},[i("Tetris")],1)},staticRenderFns:[]};var u=r("VU/8")(a,h,!1,function(t){r("9xt0")},null,null).exports;s.a.config.productionTip=!1,new s.a({el:"#app",components:{App:u},template:"<App/>"})},"n0+5":function(t,i){}},["NHnr"]);
//# sourceMappingURL=app.ff7efa82240600078981.js.map